import PortScanner

class VulnerabilityScanner:
    __vul_file = 'vul.txt'
    __open_ports = []
    __vul_banners = []
    __port_scanner = None

    def __init__(self, victim_ip, number_of_ports):
        self.victim_ip = victim_ip
        self.number_of_ports = number_of_ports
        self.__port_scanner = PortScanner.PortScanner(self.victim_ip, self.number_of_ports)
    

    def vulnerability_scan(self):
        if (not self.__port_scanner.scan()): return False
        banners = self.__port_scanner.get_tcp_banners()
        open_ports = self.__port_scanner.get_open_tcp_ports()
        cnt = 0
        with open(self.__vul_file, 'r', encoding='utf8') as file:
            for banner in banners:
                file.seek(0)
                for line in file.readlines():
                    if banner in line:
                        self.__vul_banners.append(banner)
        return True
    
    def get_vulnerability(self):
        return self.__vul_banners
                    

    